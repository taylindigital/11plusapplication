{"version":3,"file":"generateAccountSas.js","sourceRoot":"","sources":["../../../src/sas/generateAccountSas.ts"],"names":[],"mappings":";AAAA,uCAAuC;AACvC,kCAAkC;;AAqBlC,gDAoCC;;AAtDD,yEAA6E;AAE7E,mEAAmG;AAEnG,gDAAwD;AAGxD,iFAAmF;AAEnF;;;;;;;;GAQG;AACH,SAAgB,kBAAkB,CAChC,UAA8B,EAC9B,UAA6B,EAAE;IAE/B,MAAM,EACJ,SAAS,EACT,WAAW,GAAG,IAAA,0DAA+B,EAAC,IAAI,CAAC,EACnD,aAAa,GAAG,KAAK,EACrB,QAAQ,GAAG,IAAA,oDAA4B,EAAC,GAAG,CAAC,KAE1C,OAAO,EADN,IAAI,kBACL,OAAO,EANL,yDAML,CAAU,CAAC;IACZ,IAAI,CAAC,IAAA,gCAAoB,EAAC,UAAU,CAAC,EAAE,CAAC;QACtC,MAAM,UAAU,CACd,+FAA+F,CAChG,CAAC;IACJ,CAAC;IAED,IAAI,MAAM,GAAG,SAAS,CAAC;IAEvB,IAAI,MAAM,KAAK,SAAS,EAAE,CAAC;QACzB,MAAM,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;QACvB,MAAM,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;IACjD,CAAC;IAED,MAAM,GAAG,GAAG,IAAA,gEAAiC,kBAEzC,WAAW,EACX,SAAS,EAAE,MAAM,EACjB,aAAa,EACb,QAAQ,EAAE,IAAA,kDAA0B,EAAC,QAAQ,CAAC,IAC3C,IAAI,GAET,UAAU,CACX,CAAC,QAAQ,EAAE,CAAC;IAEb,OAAO,GAAG,CAAC;AACb,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport type { AccountSasPermissions } from \"./accountSasPermissions.js\";\nimport { accountSasPermissionsFromString } from \"./accountSasPermissions.js\";\nimport type { AccountSasServices } from \"./accountSasServices.js\";\nimport { accountSasServicesFromString, accountSasServicesToString } from \"./accountSasServices.js\";\nimport type { NamedKeyCredential } from \"@azure/core-auth\";\nimport { isNamedKeyCredential } from \"@azure/core-auth\";\nimport type { SasIPRange } from \"./sasIPRange.js\";\nimport type { SasProtocol } from \"./sasQueryParameters.js\";\nimport { generateAccountSasQueryParameters } from \"./accountSasSignatureValues.js\";\n\n/**\n * Generates a Table Account Shared Access Signature (SAS) URI based on the client properties\n * and parameters passed in. The SAS is signed by the shared key credential of the client.\n *\n * @see https://learn.microsoft.com/en-us/rest/api/storageservices/create-account-sas\n *\n * @param options - Optional parameters.\n * @returns An account SAS token\n */\nexport function generateAccountSas(\n  credential: NamedKeyCredential,\n  options: AccountSasOptions = {},\n): string {\n  const {\n    expiresOn,\n    permissions = accountSasPermissionsFromString(\"rl\"),\n    resourceTypes = \"sco\",\n    services = accountSasServicesFromString(\"t\"),\n    ...rest\n  } = options;\n  if (!isNamedKeyCredential(credential)) {\n    throw RangeError(\n      \"Can only generate the account SAS when the client is initialized with a shared key credential\",\n    );\n  }\n\n  let expiry = expiresOn;\n\n  if (expiry === undefined) {\n    const now = new Date();\n    expiry = new Date(now.getTime() + 3600 * 1000);\n  }\n\n  const sas = generateAccountSasQueryParameters(\n    {\n      permissions,\n      expiresOn: expiry,\n      resourceTypes,\n      services: accountSasServicesToString(services),\n      ...rest,\n    },\n    credential,\n  ).toString();\n\n  return sas;\n}\n\n/**\n * Options to configure {@link generateAccountSas} operation.\n */\nexport interface AccountSasOptions {\n  /**\n   * The time at which the shared access signature becomes invalid. Default to an hour later if not provided.\n   */\n  expiresOn?: Date;\n  /**\n   * Specifies the list of permissions to be associated with the SAS.\n   */\n  permissions?: AccountSasPermissions;\n  /**\n   * Specifies the resource types associated with the shared access signature.\n   */\n  resourceTypes?: string;\n  /**\n   * The version of the service this SAS will target. If not specified, it will default to the version targeted by the\n   * library.\n   */\n  version?: string;\n\n  /**\n   * SAS protocols allowed.\n   */\n  protocol?: SasProtocol;\n\n  /**\n   * When the SAS will take effect.\n   */\n  startsOn?: Date;\n  /**\n   * IP range allowed.\n   */\n  ipRange?: SasIPRange;\n  /**\n   * Account services\n   */\n  services?: AccountSasServices;\n}\n"]}