<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrightStars Education Portal</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="assets/css/main.css" as="style">
    <link rel="preload" href="assets/css/components.css" as="style">
    <link rel="preload" href="https://alcdn.msauth.net/browser/2.38.3/js/msal-browser.min.js" as="script">
    
    <!-- CSS Files - Load critical CSS first -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
    
    <!-- External Libraries -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,400;1,500;1,600&display=swap" rel="stylesheet">
    
    <!-- MSAL Library with fallback -->
    <script>
        // Try multiple MSAL CDN sources
        async function loadMSAL() {
            const msalSources = [
                'https://alcdn.msauth.net/browser/2.38.3/js/msal-browser.min.js',
                'https://cdn.jsdelivr.net/npm/@azure/msal-browser@2.38.3/lib/msal-browser.min.js',
                'https://unpkg.com/@azure/msal-browser@2.38.3/lib/msal-browser.min.js'
            ];
            
            for (let i = 0; i < msalSources.length; i++) {
                try {
                    console.log(`Trying MSAL source ${i + 1}: ${msalSources[i]}`);
                    await loadScript(msalSources[i]);
                    if (typeof msal !== 'undefined') {
                        console.log('MSAL loaded successfully from source', i + 1);
                        return;
                    }
                } catch (error) {
                    console.log(`MSAL source ${i + 1} failed:`, error);
                }
            }
            console.error('All MSAL sources failed to load');
        }
        
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }
        
        // Start loading MSAL immediately
        loadMSAL();
    </script>
    
    <!-- Performance optimizations -->
    <meta name="theme-color" content="#8B5FBF">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/images/bright-stars-logo.png">
</head>
<body>
    <!-- Loading overlay for better UX -->
    <div id="loading-overlay" class="loading-overlay">
        <div style="text-align: center;">
            <div class="loading-spinner large"></div>
            <p style="margin-top: 16px; color: var(--text-medium);">Loading...</p>
        </div>
    </div>

    <!-- Single Page App Container -->
    <div id="app">
        <!-- Content will be dynamically rendered here by JavaScript -->
    </div>

    <!-- JavaScript - Load the complete single-page application -->
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/user-management.js"></script>
    <script src="assets/js/app.js"></script>

</body>
</html>